library(wordcloud)
library(stringr)
library(RColorBrewer)
library(tm)
library(wordcloud2)
data1_1 <- Corpus(VectorSource(data1))
data1_1
head(data1_1)
View(data1_1)
data1
library(rJava)
library(memoise)
useNIADic()
useNIADic()
data1_1 <- str_replace_all(data1, "||W", "")
data1 <- readLines("hiphop.txt")
data1_1 <- str_replace_all(data1, "||W", "")
data1_1
data1
head(data1)
head(data1_1)
head(data1,100)
head(data1_100)
head(data1,100)
head(data1_1,100)
data1_1 <- str_replace_all(data1, "\\W", "")
head(data1_1,100)
data1_1 <- str_replace_all(data1, "\\W"," ")
head(data1_1,100)
data1_1 <- extractNoun(data1_1)
data1_1
data1_2 <- as.data.frame(data1_1, stringsAsFactors = F)
data1_2 <- as.data.frame(data1_1, stringsAsFactors = F)
data1_1 <- Filter(function(x) {nchar(x) >= 2} ,data1_1)
data1_1
data1_2 <- unlist(data1_1)
data1_2
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),500)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1 <- readLines("hiphop.txt")
data1_1 <- str_replace_all(data1, "\\W"," ")
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),500)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),1000)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_4
data1_2 <-head(sort(data1_2, decreasing = T),1000)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_2 <-head(sort(data1_2, decreasing = T),10)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),20)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),20)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_2 <-head(sort(data1_2, decreasing = T),1)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
wordcloud2(data1_5)
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
library(tm)
library(KoNLP)
library(wordcloud2)
library(stringr)
library(RColorBrewer)
library(rJava)
library(memoise)
useNIADic()
data1 <- readLines("hiphop.txt")
data1_1 <- str_replace_all(data1, "\\W"," ")
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2 <-head(sort(data1_2, decreasing = T),)
write(unlist(data1_2),"data1_3.txt")
data1_4 <- readLines("data1_3.txt")
nrow(data1_4)
data1_5 <- table(data1_4)
wordcloud2(data1_5)
data1_2
data1_1 <- extractNoun(data1_1)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2
data1_3 <- as.data.frame(data1_2)
View(data1_3)
library(sqldf)
library(dplyr)
data1_3
View(data1_3)
View(data1_1)
data1_3 %>%
mutate(no = 1) %>%
group_by(data1_2)
data1_4 <- table(unlist(data1_1))
data1_4
data1_1 <- extractNoun(data1_1)
data1_2 <- table(unlist(data1_1))
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2
data1_3 %>%
mutate(no = 1) %>%
group_by(data1_2)
View(data1_3)
data1_3 %>%
mutate(no = 1) %>%
group_by(data1_2)
data1_3 <- as.data.frame(data1_2)
View(data1_3)
data1_4 <- data1_3 %>%
filter(var1, function(x) {nchar(x) >= 2})
data1_4 <- data1_3 %>%
filter(Var1, function(x) {nchar(x) >= 2})
data1_4 <- data1_3 %>%
filter(Var1, nchar(x) >= 2)
data1_2 <- unlist(data1_1)
data1_2 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_2
data1_3
data1_3 <- Filter(function(x) {nchar(x) >= 2} ,data1_2)
data1_4 <- as.data.frame(data1_3)
data1_4
View(data1_4)
table(data1_4)
View(data1_4)
View(data1_4)
data1 <- readLines("hiphop.txt")
data1_1 <- str_replace_all(data1, "\\W"," ")
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
View(data1_4)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_5
View(data1_5)
data1_5 <- gsub(" ","", data1_5)
data1_5
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_6 <- gsub(" ","", data1_5)
data1 <- readLines("hiphop.txt")
data1_1 <- str_replace_all(data1, "\\W"," ")
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
View(data1_5)
data1_6 <- data1_5 %>%
arrange(desc(freq)) %>%
head(500)
data1_6 <- data1_5 %>%
arrange(desc(Var1)) %>%
head(500)
write(unlist(data1_6),"data1_6.txt")
data1_7 <- readLines("data1_6.txt")
nrow(data1_7)
data1_8 <- table(data1_7)
wordcloud2(data1_8)
data1_6 <- data1_5 %>%
arrange(desc(Var1)) %>%
head(10)
write(unlist(data1_6),"data1_6.txt")
data1_7 <- readLines("data1_6.txt")
nrow(data1_7)
data1_8 <- table(data1_7)
wordcloud2(data1_8)
data1_4
data1_3
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_3 <- gsub("\\d+","", data3)
data1_3 <- gsub("\\d+","", data1_3)
data1_3 <- gsub(" ","", data1_3)
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_3 <- gsub("\\d+","", data1_3)
data1_3 <- gsub(" ","", data1_3)
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_4
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_3 <- gsub("\\d+","", data1_3)
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_4 <- as.data.frame(data1_3, stringsAsFactors = F)
data1_5 <- filter(data1_4, nchar(Var1) >= 2)
data1_6 <- data1_5 %>%
arrange(desc(Var1)) %>%
head(10)
write(unlist(data1_6),"data1_6.txt")
data1_7 <- readLines("data1_6.txt")
nrow(data1_7)
data1_8 <- table(data1_7)
wordcloud2(data1_8)
data1_6 <- gsub("\\d+","", data1_5[,1])
data1_6
data1_3 <- table(unlist(data1_2))
data1_3
data1_4 <- filter(data1_3, nchar(Var1) >= 2)
data1_3 <- table(unlist(data1_2))
data1_4 <- gsub("\\d+","", data1_3)
data1_4
data1_5 <- table(unlist(data1_4))
data1_5
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data1_2 <- extractNoun(data1_1)
data1_2 <- extractNoun(data1_1)
data1 <- readline("hiphop.txt")
data1
data1 <- readLines("hiphop.txt")
data1_1 <- readLines("hiphop.txt")
data1_2 <- extractNoun(data1_1)
data1_3 <- table(unlist(data1_2))
data2 <- sapply(data1, extractNoun, USE.NAMES = F)
data2
data1_1 <- readLines("hiphop.txt")
data1_2 <- str_remove_all(data1_1,"\\W"," ")
data1_2 <- str_replace_all(data1_1,"\\W"," ")
data1_2
data1_3 <- str_replace_all(data1_1,"\\d+"," ")
data1_3
data1_3 <- str_replace_all(data1_2,"\\d+"," ")
data1_3
data1_1 <- readLines("hiphop.txt")
data1_2 <- str_replace_all(data1_1,"\\W"," ")
data1_3 <- str_replace_all(data1_2,"\\d+"," ")
data1_4 <- extractNoun(data1_3)
data1_5 <- table(unlist(data1_4))
data1_6 <- as.data.frame(data1_5, stringsAsFactors = F)
data1_7 <- filter(data1_6, nchar(Var1) >= 2)
data1_8 <- data1_7 %>%
arrange(desc(Var1)) %>%
head(10)
data1_8
data1_8 <- data1_7 %>%
arrange(desc(Freq)) %>%
head(10)
data1_8
data1_8 <- data1_7 %>%
arrange(desc(Freq)) %>%
head(500)
data1_8
wordcloud2(data1_8)
library(ggplot2)
top10 <- data1_7 %>%
arrange(desc(Freq)) %>%
head(10)
top10
ggplot(top10, ase(x="", y=Freq, fill=Var1)) +
geom_bar(stat="identity")
ggplot(top10, aes(x="", y=Freq, fill=Var1)) +
geom_bar(stat="identity")
ggplot(top10, aes(x="", y=Freq, fill=Var1)) +
coord_polar(theta = "y")
ggplot(top10, aes(x=" ", y=Freq, fill=Var1)) +
coord_polar(theta = "y")
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
coord_polar(theta = "y")
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
coord_polar(theta = "y")
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
coord_polar(theta = "y")
class(top10)
View(top10)
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y")
wordcloud2(data1_7)
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y")
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y") +
ggtitle(" Top 10 단어 원 그래프 ")
ggplot(top10, aes(x='', y=Freq, fill=Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y") +
ggtitle(" Top 10 원 그래프 ")
p <- ggplot(top10, aes(x='', y=Freq, fill=Var1))
p
p + geom_bar(stat="identity")
p + geom_bar(stat="identity") +
coord_polar(theta = "y")
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Freq, label=Var1))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', label=Var1))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes( y=Freq, label=Var1))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Freq))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Freq, label=Var1))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Var1, label=F
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Var1, label=Freq))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Var1, label=Freq))
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y=Var1, label=Freq))
p <- ggplot(top10, aes(x='', y=Freq, fill=Var1))
p + geom_bar(stat="identity")
p + geom_bar(stat="identity") +
coord_polar(theta = "y")
top10_1 <- rename(top10, top10 = Var1, "빈도" = Freq)
top10_1
p <- ggplot(top10_1, aes(x='', y="빈도", fill= top10))
p + geom_bar(stat="identity")
p + geom_bar(stat="identity") +
coord_polar(theta = "y")
p + geom_bar(stat="identity") +
coord_polar(theta = "y") +
geom_text(aes(x='', y='', label=top10))
p + geom_bar(stat="identity") +
coord_polar(theta = "y")
p + geom_bar(stat="identity") +
coord_polar(theta = "x")
p + geom_bar(stat="identity") +
coord_polar(theta = "fill")
p + geom_bar(stat="identity") +
coord_polar(theta = "y")
p + geom_bar(stat="identity")
View(top10_1)
top10_2 <- top10_1 %>%
mutate("퍼센트" = "빈도"/sum("빈도")*100)
top10_2 <- top10_1 %>%
mutate("퍼센트" = '빈도'/sum('빈도')*100)
top10_2 <- top10_1 %>%
mutate("퍼센트" = ''빈도''/sum(''빈도'')*100)
data1_1 <- readLines("hiphop.txt")
data1_2 <- str_replace_all(data1_1,"\\W"," ")
data1_3 <- str_replace_all(data1_2,"\\d+"," ")
data1_4 <- extractNoun(data1_3)
data1_5 <- table(unlist(data1_4))
data1_6 <- as.data.frame(data1_5, stringsAsFactors = F)
data1_7 <- filter(data1_6, nchar(Var1) >= 2)
top10 <- data1_7 %>%
arrange(desc(Freq)) %>%
head(10)
View(top10)
top10_1 <- top10 %>%
mutate("%" = Freq / sum(Freq)*100)
top10_1
top10_1 <- top10 %>%
mutate("%" = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",'%'),'%', sep = ''))
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = ''))
top10_1
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
top10_1
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
arrange(desc(Freq)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
top10_1
ggplot(top10_1, aes(x='', y="빈도", fill= top10)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
ggtitle(" Top 10 원 그래프 ") +
geom_text(aes(y=ypos, label=ylabel), color='black')
View(top10_1)
ggplot(top10_1, aes(x='', y = Var1, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
ggtitle(" Top 10 원 그래프 ") +
geom_text(aes(y=ypos, label=ylabel), color='black')
ggplot(top10_1, aes(x='', y = Var1, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y") +
ggtitle(" Top 10 원 그래프 ") +
geom_text(aes(y=ypos, label=ylabel), color='black')
top10_1
options(digits = 2)
ggplot(top10_1, aes(x='', y = Var1, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
ggtitle(" Top 10 원 그래프 ") +
geom_text(aes(y=ypos, label=ylabel), color='black')
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
ggtitle(" Top 10 원 그래프 ") +
geom_text(aes(y=ypos, label=ylabel), color='black')
top10_1
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
geom_text(aes(y=ypos, label=ylabel), color='black')
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
arrange(desc(Var1)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
geom_text(aes(y=ypos, label=ylabel))
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
arrange(desc(Var1)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
top10_1
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
arrange(desc(Var1)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
top10_1
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
geom_text(aes(y=ypos, label=ylabel))
library(dplyr)
install.packages('extrafont')
library(extrafont)
top10_1 <- top10 %>%
mutate(pct = Freq / sum(Freq)*100) %>%
mutate(ylabel = paste(sprintf("%4.1f",pct),'%', sep = '')) %>%
arrange(desc(Var1)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
geom_text(aes(y=ypos, label=ylabel))
ggplot(top10_1, aes(x='', y = Freq, fill = Var1)) +
geom_bar(stat="identity") +
coord_polar(theta = "y", start = 0) +
geom_text(aes(y=ypos, label=ylabel))
